{% extends "base.html" %}
{% block title %}Admin - Manual Deposits & Withdrawals{% endblock %}

{% block content %}
<div class="container mt-5">
  <h3 class="mb-4">Pending Manual Deposits</h3>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, msg in messages %}
      <div class="alert alert-{{ category }}">{{ msg }}</div>
    {% endfor %}
  {% endwith %}

  {% if deposits %}
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Email</th>
        <th>Amount</th>
        <th>Screenshot</th>
        <th>Submitted At</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for deposit in deposits %}
      <tr>
        <td>{{ deposit.email }}</td>
        <td>{{ deposit.amount }}</td>
        <td><a href="{{ deposit.screenshot_url }}" target="_blank">View</a></td>
        <td>{{ deposit.timestamp.split('T')[0] }}</td>
        <td>
          <a href="{{ url_for('approve_manual_deposit_route', deposit_id=deposit.id) }}" class="btn btn-success btn-sm">Approve</a>
          <a href="{{ url_for('reject_manual_deposit_route', deposit_id=deposit.id) }}" class="btn btn-danger btn-sm">Reject</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info">No pending manual deposits at this time.</div>
  {% endif %}
</div>

<hr>

<div class="container mt-5">
  <h3 class="mb-4">Pending Withdrawal Requests</h3>

  {% if withdrawals %}
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Email</th>
        <th>Amount</th>
        <th>Wallet Type</th>
        <th>Wallet ID</th>
        <th>Requested At</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for w in withdrawals %}
      <tr>
        <td>{{ w.email }}</td>
        <td>${{ w.amount }}</td>
        <td>{{ w.wallet_type }}</td>
        <td>{{ w.wallet_id }}</td>
        <td>{{ w.created_at.split("T")[0] }}</td>
        <td>
          <a href="{{ url_for('approve_withdrawal_route', withdraw_id=w.id) }}" class="btn btn-success btn-sm">Approve</a>
          <a href="{{ url_for('reject_withdrawal_route', withdraw_id=w.id) }}" class="btn btn-danger btn-sm">Reject</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info">No pending withdrawals at this time.</div>
  {% endif %}
</div>
{% endblock %}
