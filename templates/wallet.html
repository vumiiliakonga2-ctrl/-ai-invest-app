{% extends "base.html" %}
{% block title %}Wallet - AI Investment{% endblock %}

{% block content %}
<div class="container mt-5">
  <h3 class="text-center mb-4">Your Wallet</h3>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, msg in messages %}
      <div class="alert alert-{{ category }}">{{ msg }}</div>
    {% endfor %}
  {% endwith %}

  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card p-3 border-success">
        <h5 class="text-success">Available Balance</h5>
        <p class="fs-4 fw-bold text-success">${{ wallet.available }}</p>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card p-3 border-warning">
        <h5 class="text-warning">Locked Balance</h5>
        <p class="fs-4 fw-bold text-warning">${{ wallet.locked }}</p>
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-center gap-4 mb-4">
    <a href="{{ url_for('deposit') }}" class="btn btn-outline-success px-4 py-2">Deposit</a>
    <a href="{{ url_for('withdraw') }}" class="btn btn-outline-danger px-4 py-2">Withdraw</a>
  </div>

  <hr class="my-4">

  {% if transactions %}
  <h5 class="mb-3">Recent Transactions</h5>
  <table class="table table-sm table-striped">
    <thead>
      <tr>
        <th>Type</th>
        <th>Amount</th>
        <th>Status</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      {% for tx in transactions %}
      <tr>
        <td>{{ tx.tx_type|capitalize }}</td>
        <td>${{ tx.amount }}</td>
        <td>
          {% if tx.status == 'finished' %}
            <span class="badge bg-success">Success</span>
          {% elif tx.status == 'pending' %}
            <span class="badge bg-warning text-dark">Pending</span>
          {% elif tx.status == 'rejected' %}
            <span class="badge bg-danger">Rejected</span>
          {% else %}
            <span class="badge bg-secondary">{{ tx.status }}</span>
          {% endif %}
        </td>
        <td>{{ tx.timestamp.split('T')[0] }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info text-center">No transactions yet.</div>
  {% endif %}
</div>
{% endblock %}
